* Copy as Org-Mode
A WebExtension to copy selected web page into Org-mode formatted text!

#+begin_html
<blockquote>
I develop and release <b>ALL</b> my open-source software projects <b>for free</b>, and are ALL licensed under <b><code>WTFPL</code>, <code>GPL</code>, <code>MIT</code>, or <code>MPL</code>. however, my "free time" is not free actually</b>. If my works are usable to you or make you happy, please consider to donate to <b>reduce my business hours to <i>make more free and open-source projects for you and this world</i></b>:
<ul>
  <li><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=G4F7NM38ADPEC&source=url"> <img width="24" height="24" src="https://raw.githubusercontent.com/kuanyui/kuanyui/main/img/paypal.svg"/>PayPal</a></li>
  <li><a href="https://liberapay.com/onoono"> <img width="24" height="24" src="https://raw.githubusercontent.com/kuanyui/kuanyui/main/img/liberapay.svg"/>LiberaPay</a></li>
  <li><a href="https://www.patreon.com/onoono"> <img width="24" height="24" src="https://raw.githubusercontent.com/kuanyui/kuanyui/main/img/patreon.svg"/>Patreon</a></li>
</ul>
Thanks for your contribution!
</blockquote>
#+end_html

* Install
  #+begin_quote
  *This addon has been submitted to Mozilla Add-ons, but may be still unavailable in at the moment because it is still pending for manual reviewing by Mozilla. So please be patient until they approve the submission. DON'T OPEN ISSUE ABOUT THIS.*
  #+end_quote
- [[https://addons.mozilla.org/en-US/firefox/addon/copy-as-org-mode/][Mozilla Add-ons]]

* Screenshot
[[https://addons.cdn.mozilla.net/user-media/previews/full/261/261819.png?modified=1632850827]]
[[https://addons.cdn.mozilla.net/user-media/previews/full/261/261818.png?modified=1632850827]]
* Supported Browser
- Firefox for Desktop >= 92

* Requirements for Development
- Node
- web-ext
- GNU Make

* Support Syntax
- *bold*, /italic/, _underline_, +strike+, =verbatim=, ~code~
- Quoteblock, Codeblock (auto guess language ID. e.g. =js=, =c=, =shell=)
- Table

* Known Issues (Please feel free to open PR to fix them)
- It's *IMPOSSIBLE* to use this add-on under some special pages or domains like https://addons.mozilla.org/ . This is the restriction of Firefox browser itself.
- Nested mark (e.g. =*_+a+_*=) may has some issues for org-mode renderer. *This is the limitation of org-mode's syntax & renderer, I cannot do anything for it*.
- The child HTML elements in =<a>= (e.g. =<img>=) may cannot be handled properly. *This is the limitation of org-mode's syntax, I cannot do anything for it*.
- =<pre>= may lost newlines in some page (e.g. https://kuanyui.github.io/2017/08/16/macros-for-qproperty/). Should be fixed now but I cannot sure.
- Notification may freeze the whole Firefox *when using on Linux* (Test on Firefox 92, Ubuntu & Manjaro), but such issue seems not occurs on Firefox for Windows. So I make this feature an optional setting, you can enable it manually.


* Development
** Prepare
#+BEGIN_SRC sh
npm i
#+END_SRC

** Run for development (Watch)
#+BEGIN_SRC sh
make dev
web-ext run --verbose --firefox-profile ~/.mozilla/firefox/PROFILE_DIR_NAME
#+END_SRC
#+BEGIN_QUOTE
If webpack watch exit immediately without any error, please try [[https://github.com/guard/listen/wiki/Increasing-the-amount-of-inotify-watchers]]
#+END_QUOTE

** Run Firefox for developing WebExtension
#+BEGIN_SRC sh
web-ext run --verbose --firefox-profile ~/.mozilla/firefox/XXXXXXX.NAME
#+END_SRC

** Deploy (Build .xpi file & run a HTTP server for download)
#+BEGIN_SRC sh
make xpi-server
#+END_SRC

** Zip this repository for uploading to addons.mozilla.org
#+BEGIN_SRC sh
make zip-repo
#+END_SRC

* Acknowedgement
  This project referred, forked, or used some parts of the codes from the other projects:

| Project URL                                                                             | Usage                                               | Licenses of Used Parts |
|-----------------------------------------------------------------------------------------+-----------------------------------------------------+------------------------|
| [[https://github.com/0x6b/copy-selection-as-markdown][0x6b/copy-selection-as-markdown]] | Main project structure; copy and selection handling | MIT                    |
| [[https://github.com/mixmark-io/turndown][mixmark-io/turndown]]                         | Forked as HTML to Org-Mode converter                | MIT                    |
| [[https://github.com/piroor/treestyletab/][piroor/treestyletab]]                        | The CSS for ~options_ui~ (settings page)            | MPL 2.0; MIT           |


* TODOs
- Customizable keyboard shortcuts.
- Image to data URL?

* License
MPL-2.0.

See LICENSE for more information.
